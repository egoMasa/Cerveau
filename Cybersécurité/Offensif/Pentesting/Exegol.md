
#  **1) Présentation de Exegol**

Exegol est **un environnement de pentest basé sur Docker**, conçu pour **déployer rapidement un conteneur** contenant **tous les outils nécessaires au hacking**. Il constitue **une alternative légère et flexible** à Kali Linux ou Parrot.

## ** Pourquoi utiliser Exegol ?**

✅ **Léger & rapide** → Exegol fonctionne en conteneur Docker, évitant l'utilisation de machines virtuelles lourdes.  
✅ **Modulaire** → Ajout et suppression d'outils sans polluer le système hôte.  
✅ **Prêt à l'emploi** → Livré avec Burp Suite, Nmap, SQLmap, ffuf, etc.  
✅ **Persistance des données** → Conserve les configurations entre les sessions.  
✅ **Portable & sécurisé** → Compatible avec Linux, Windows et macOS.  
✅ **Flexibilité maximale** → Permet de créer des environnements isolés et reproductibles.

# **2) Installation de Exegol**

Exegol peut être installé de **deux façons** : via **pipx** (méthode simple et recommandée) ou **depuis les sources**.

### **1 -  Installer `pipx` (si non présent)**
```bash
sudo apt update && sudo apt install pipx
```

Ou via pip :
```bash
python3 -m pip install pipx
```

### **2 -  Installer Exegol avec `pipx`**
```bash
pipx install exegol
```

Pipx permet **d’isoler Exegol** dans un environnement Python dédié.

### **3 - Ajouter Exegol au `PATH`**
```bash
pipx ensurepath
```

**Ouvre un nouveau terminal** pour appliquer la modification.

### **4 -  Configurer les permissions Docker**

Exegol **ne supporte pas Docker en mode rootless**, donc :

- **Ajoute ton utilisateur au groupe Docker** pour éviter d’utiliser `sudo` à chaque fois :
    ```bash
    sudo usermod -aG docker $USER
    newgrp docker
    ```
    
- **Ou configure un alias pour l’exécuter en `sudo`** :
    ```bash
    echo "alias exegol='sudo -E $(which exegol)'" >> ~/.bash_aliases
    source ~/.bashrc
    ```
    
### **5 - Télécharger et installer une image Exegol**

Une fois Exegol installé, télécharger une image :

```bash
exegol install
```

Il existe plusieurs version installables selon nos besoins** (`full`, `web`, `osint`, `light`, etc.).

| **Image**   | **Taille (approx.)** | **Utilisation principale**                                                                                     |
| ----------- | -------------------- | -------------------------------------------------------------------------------------------------------------- |
| **nightly** | ~62.3GB              | **Version de développement**, mise à jour tous les jours avec les derniers outils. **Peut contenir des bugs**. |
| **web**     | ~28.8GB              | **Spécialisée pour le pentest web**, avec des outils comme Burp Suite, sqlmap, nuclei, etc.                    |
| **osint**   | ~15.8GB              | **OSINT (Open Source Intelligence)** → Outils de collecte d'infos (theHarvester, Maltego, recon-ng, etc.).     |
| **light**   | ~17.7GB              | **Version allégée**, avec uniquement les outils essentiels pour du pentest généraliste.                        |
| **ad**      | ~44.8GB              | **Spécialisée Active Directory** → Contient des outils comme BloodHound, impacket, CrackMapExec.               |
| **full**    | ~61.0GB              | **Version complète**, contient **tous les outils** de toutes les versions combinées.                           |


# **📌 Auto-complétion (optionnel)**

Pour **activer l'auto-complétion** dans ton terminal : 

1. **Installer `argcomplete` si nécessaire** :

```bash
sudo apt install python3-argcomplete
```

2. **Ajouter l’auto-complétion au système** :

```bash
register-python-argcomplete --no-defaults exegol | sudo tee /etc/bash_completion.d/exegol > /dev/null
```

3. **Activer `bash-completion` (si non installé)** :

```bash
sudo apt install bash-completion
```

# 3) Première utilisation de Exegol 
* Lancer une instance Exegol
```bash
$ exegol start    
[*] Exegol is currently in version v4.3.10  
[*] Exegol Discord serv.: https://discord.gg/cXThyp7D6P  
[*] Exegol documentation: https://exegol.rtfd.io/  
[*] Starting exegol                                                                            
[!] No containers have been created yet                                                        
  
 Available images                                 
┌───────────┬─────────┬─────────────────────────┐  
│ Image tag │ Size    │ Status                  │  
├───────────┼─────────┼─────────────────────────┤  
│ nightly   │ 56.4GB  │ Up to date (v.bb147a38) │  
│ web       │ ~28.8GB │ Not installed           │  
│ osint     │ ~15.8GB │ Not installed           │  
│ light     │ ~17.7GB │ Not installed           │  
│ ad        │ ~44.8GB │ Not installed           │  
│ full      │ ~61.0GB │ Not installed           │  
└───────────┴─────────┴─────────────────────────┘  
  
[*] You can use a name that does not already exist to build a new image from local sources     
[?] Select an image by its name (nightly):    
[?] Enter the name of your new exegol container (default):        
  
⭐ Container summary                                           
┌──────────────────┬───────────────────────────────────────┐  
│             Name │ default                               │  
│            Image │ nightly - v.bb147a38 (Up to date)     │  
├──────────────────┼───────────────────────────────────────┤  
│      Credentials │ root : [PASSPHRASE] │  
│   Remote Desktop │ Off 望                                │  
│      Console GUI │ On ✔ (X11 + Wayland)                  │  
│          Network │ host                                  │  
│         Timezone │ On ✔                                  │  
│ Exegol resources │ On ✔ (/opt/resources)                 │  
│     My resources │ On ✔ (/opt/my-resources)              │  
│    Shell logging │ Off 望                                │  
│       Privileged │ Off ✔                                 │  
│        Workspace │ Dedicated (/workspace)                │  
└──────────────────┴───────────────────────────────────────┘  
  
[?] Is the container configuration correct? [Y/n]:    
[*] Command line of the configuration: exegol start default nightly                            
[*] To use exegol without interaction, read CLI options with exegol start -h                   
[*] Creating new exegol container                                                              
[+] Exegol container successfully created !                                                    
[*] Location of the exegol workspace on the host : /home/egomasa/.exegol/workspaces/default    
[+] Opening shell in Exegol 'default'
[Feb 28, 2025 - 14:18:34 (CET)] exegol-default /workspace # ls -l  
total 0  
[Feb 28, 2025 - 14:19:27 (CET)] exegol-default /workspace # pwd
```
## Actions récurrentes et manipulation 
1. Lister tous les conteneurs (actifs et stoppés)
```bash
docker ps --filter "name=exegol" #execution
docker ps -a --filter "name=exegol" # all
```
2. Lancer ou rejoindre un nouveau conteneur
```bash
exegol start [NOM] [IMAGE] #créer
exegol start [NOM] #rejoindre
```
3. Arrêter un conteneur
```bash
exegol stop [nom_du_conteneur]
```
4. Redémarrer un conteneur 
```bash
sudo apt install bash-completion
```
5. Supprimer définitivement un conteneur
```bash
exegol remove [nom_du_conteneur]
```

## Utilisations spécifique en CTF/Pentest
1. Exécuter une commande dans un conteneur
```bash
exegol exec [nom_du_conteneur] [commande]
exegol exec pentest bloodhound
exegol exec -v pentest "nmap -h" #sortie visible
exegol exec -b pentest bloodhound #arrière-plan
```
1. Lancer plusieurs conteneurs en parralle et passer de l'un à l'autre 
```bash
exegol start pentest1 full
exegol start pentest2 web

(pentest1)$exit
exegol start pentest2`
(pentest2)$
```

# **📌 Utilisation & Commandes essentielles**

| **Commande**                          | **Action**                                           |
| ------------------------------------- | ---------------------------------------------------- |
| `exegol info`                         | Voir les images Exegol disponibles et installées     |
| `exegol version`                      | Vérifier la version d’Exegol installée               |
| `exegol install [image]`              | Télécharger et installer une image Exegol            |
| `exegol remove [image]`               | Supprimer une image Exegol installée                 |
| `exegol start [nouveau_nom] [image]`  | Lancer un conteneur Exegol spécifique                |
| `exegol stop [nom]`                   | Arrêter un conteneur Exegol                          |
| `exegol restart [nom]`                | Redémarrer un conteneur Exegol                       |
| `exegol exec [nom] [commande]`        | Exécuter une commande dans un conteneur Exegol       |
| `docker ps --filter "name=exegol"`    | Lister les conteneurs Exegol en cours d’exécution    |
| `docker ps -a --filter "name=exegol"` | Lister tous les conteneurs Exegol, y compris arrêtés |
| `docker rm -f [nom_du_conteneur]`     | Supprimer un conteneur Exegol spécifique             |
