
# Objectifs
* Récupérer des informations sur un cible ou un groupe de cible
* Analyse de ports
* Enumération de partage
* Enumération de répetoires web
* Enumération d'utilisateurs 
* Enumération de nom de domaine
--- 
# 1) Analyse de ports 
## 1.1) Nmap 
### Comportement de base de nmap
- **Ports**: Par défaut, Nmap scanne les 1 000 ports TCP les plus couramment utilisés.
- **Vitesse**: Si aucune option de timing n'est spécifiée, Nmap choisit un timing basé sur le réseau et la cible. L'option `-T3` est généralement le niveau de timing par défaut.
- **Scripts**: Les scripts ne sont pas exécutés par défaut. Vous devez utiliser `-sC` ou `--script` pour spécifier les scripts que vous voulez exécuter.
- **Technique de scan**: Nmap utilisera le scan SYN (ou "half-open" scan) par défaut si exécuté en tant que root. Sinon, il utilise le scan connect(). Le scan SYN est plus rapide et moins intrusif que le scan connect(), car il n'établit jamais de connexion complète.

### Options courantes
* -A : combinaison de plusieurs fonctionnalités avancées.
	1. **Détection du système d'exploitation (`-O`)** : Nmap essaiera de déterminer le système d'exploitation (OS) de la cible.
	2. **Détection de version (`-sV`)** : Nmap déterminera les services en cours d'exécution sur les ports ouverts et tentera d'identifier leur version spécifique.
	3. **Script scan (`-sC`)** : Exécute un ensemble de scripts NSE (Nmap Scripting Engine) par défaut. Ces scripts sont généralement considérés comme "sûrs" à exécuter, mais ils peuvent être très informatifs et révéler des informations supplémentaires sur la cible.
	4. **Traceroute (`--traceroute`)** : Nmap exécutera un traceroute vers la cible pour déterminer le chemin des paquets à travers le réseau.
* TX : Vitesse d'execution du scan 
	1. **T0 (paranoiac)**: Extrêmement lent. Il envoie des paquets de manière très espacée pour réduire la probabilité d'être détecté par des dispositifs comme les IDS (systèmes de détection d'intrusion) ou les IPS (systèmes de prévention d'intrusion).
	2. **T1 (sneaky)**: Encore lent, mais pas autant que T0. Il est conçu pour être discret, mais est plus rapide que le mode paranoiac.
	3. **T2 (polite)**: Plus rapide que T1 et T0, mais prend encore des mesures pour ne pas surcharger le réseau ou la cible. Il envoie des paquets à un rythme qui devrait éviter d'encombrer le réseau.
	4. **T3 (normal)**: C'est le mode par défaut de Nmap. Il n'a pas de retard spécial entre les paquets comme les modes précédents. Dans ce mode, Nmap prend des décisions basées sur les réponses du réseau, ajustant ses délais en conséquence.
	5. **T4 (aggressive)**: Plus rapide que T3. Il envoie des paquets plus rapidement, en réduisant considérablement les délais. Il existe un risque plus élevé de fausser certains résultats ou d'engorger les réseaux avec cette option.
	6. **T5 (insane)**: C'est le mode le plus rapide. Il est utile lorsque la cible est sur un réseau local ou lorsqu'on sait que la cible peut gérer une telle quantité de trafic. Il peut facilement causer des problèmes sur les réseaux ou avec les cibles s'ils ne sont pas préparés à gérer une telle charge.

### Utilisation de nmap
1. Scan de port nmap
```
nmap [IP_CIBLE] -p- -T4 -A -oN result_nmap.txt
nmap [IP_CIBLE] -p- -T4 -sC -sV -oN result_nmap.txt
```
2. Lister les scripts NSE
```
ls /usr/share/nmap/scripts/
ls /usr/share/nmap/scripts/ | grep [PROTOCOLE]
````
3. Executer scripts NSE
```
nmap -p [PORT] --script [NOMSCRIPT] [IP_CIBLE]
nmap -p [PORT] --script [NOMSCRIPT1],[NOMSCRIPT2] [IP_CIBLE]
```


## 1.2) Autorecon

### Fonctionnalités
1. Balayage de ports & Identification des services
2. Exécution de tâches spécifiques aux services
    - Pour un service SMB, il peut lancer `enum4linux` ou d'autres outils spécifiques à SMB pour recueillir des informations.
4. Organise les résultats dans des dossiers et sous-dossiers structurés, facilitant la navigation par l'auditeur.
5. Capacité d'exécuter des outils spécifiques ou des scripts en fonction des besoins
### Utilisation
1. Lancer la reconnaissance sur l'IP cible 
```
autorecon [IP]
```



# 2) Enumération DNS 

## Whois
1. Obtenir des informations sur un nom de domaine
```
whois [DOMAINE]
```
* Registraire : Via quel registraire le nom de domaine a-t-il été enregistré ?
- Coordonnées du déclarant : Nom, organisation, adresse, téléphone, entre autres. (sauf si masqué via un service de confidentialité)
- Dates de création, de mise à jour et d'expiration 
- Name Server : À quel serveur demander pour résoudre le nom de domaine ?
## nslookup
1. Trouver l'adresse IP d'un nom de domaine
```
nslookup -type=[TYPE] [DOMAINE] [SERVER]
```
* SERVER : Le serveur auquel on souhaite envoyé la demande
* TYPE : Type de requête DNS, lister ci-dessous

|Type de requête|Résultat|
|---|---|
|A|Adresses IPv4|
|AAAA|Adresses IPv6|
|CNAME|Nom canonique|
|MX|Serveurs de messagerie|
|SOA|Début de l'autorité|
|SMS|Enregistrements TXT|
|AXFR|Transfert de zone|
|NS|Serveurs de nom|
## dig
* Pareil que nslookup mais donne des informations supplémentaires
1. Trouver l'adresse IP d'un nom de domaine
```
dig [DOMAINE]
dig [DOMAINE] [TYPE]
```
## [DNSDumpster](https://dnsdumpster.com/)
* Outil de recherche DNS avec interface graphique 
* Permet de lister et trouver des sous domaines
* Possibilité d'extraire les données
## Zone transfert 
```
dig axfr @<DNS_IP> 
dig axfr @<DNS_IP> <DOMAIN> 
```

# 3) Enumération de répetoires web
## Liste des wordlists utiles
- `/usr/share/wordlists/dirbuster/directory-list-2.3-small.txt`
- `/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt`
- `/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt` ==> Utilise pour IIS qui n'est pas sensible à la casse
- `/usr/share/seclists/Discovery/Web-Content/common.txt`
- `/usr/share/seclists/Discovery/Web-Content/big.txt`
- `/usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt`
- `/usr/share/seclists/Discovery/Web-Content/raft-large-files.txt`
## Gobuster
1. Lancer une attaque sur un URL
```
gobuster dir -u http://[IP]/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```
## Dirb 
1. Lancer une attaque sur un URL
```
dirb http://[IP]/ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

## Wfuzz
1. Lancer une attaque sur un URL
```
wfuzz -u http://[IP]/FUZZ -w /path/to/wordlist.txt
```

## Feroxbuster
1. Lancer une attaque sur un URL
```
feroxbuster --url http://[IP]
```


# 4) Enumération SMB

## enum4linux
* Permet de lister les partages et utilisateurs ainsi que des mots de passe faibles
1. Enumérer les informations à partir d'un service SMB
```
enum4linux -a [IP]
```